<!DOCTYPE html>
<html>
	<head>
		<title>Paper Mini Gen</title>
		<script src="/imagetracer_v1.2.6.js"></script>
		<style>
			svg path[fill="rgb(255,255,255)"] {
				/* TODO: great as a preview! but need to do in JS too... */
				display: none;
			}
			svg path[fill="rgb(0,0,0)"] {
				/* TODO: great as a preview! but need to do in JS too... */
				/* TODO: add HTML slider that controls this somehow... */
				stroke-width: 15;
			}
		</style>
	</head>
	<body>
		<p>
			<img src="/2025-04-03-test-outline-image.png" />
		</p>
		<p style="color: red">TODO: ADJUST CONTRAST OF IMAGE BEFORE TRACING</p>
		<a href="https://github.com/image-js/image-js"
			>https://github.com/image-js/image-js</a
		>
		<p><button onClick="traceImage()">Trace Image</button></p>
		<p>OPTIONS</p>
		<p>Path omit: <input id="pathomit" type="number" min="0" value="8" /></p>
		<p>
			Blur radius:
			<input id="blurradius" type="number" min="0" max="5" value="1" />
		</p>
		<div id="svgcontainer"></div>
		<p style="color: red">TODO: OFFSET OUTLINE OF TRACED SVG ABOVE</p>
		<script>
			function traceImage() {
				document.getElementById("svgcontainer").innerHTML = "";
				const pathomit = parseInt(document.getElementById("pathomit").value);
				const blurradius = parseInt(
					document.getElementById("blurradius").value
				);
				// Adding custom palette. This will override numberofcolors.
				const options = {
					pathomit,
					blurradius,
					colorsampling: 0,
					colorquantcycles: 1,
					strokewidth: 0,
					pal: [
						{ r: 0, g: 0, b: 0, a: 255 },
						{ r: 255, g: 255, b: 255, a: 255 },
					],
				};
				/**
				 * TODO: maybe try increasing the contrast of the image before
				 * trying to trace it?
				 *
				 * https://github.com/image-js/image-js
				 */
				// Loading an image, tracing with the 'posterized2' option preset, and appending the SVG to an element with id="svgcontainer"
				ImageTracer.imageToSVG(
					"/2025-04-03-test-outline-image.png" /* input filename / URL */,
					function (svgstr) {
						ImageTracer.appendSVGString(svgstr, "svgcontainer");
					} /* callback function to run on SVG string result */,
					options
				);
				/**
				 * TODO: process SVG, offsetting the outline,
				 * and boolean adding the resulting shapes.
				 *
				 * Step one is probably to remove the traced paths that are white.
				 * We only want to outline and boolean add the traced paths
				 * that are black. Speficially, remove paths with
				 * `fill="rgb(255,255,255)"`.
				 *
				 * Maybe you could do this by cloning the inner HTML of "svgcontainer"
				 * to a new container... and then running operations on that container.
				 * Eg get element by attribute, where "fill" === "rgb(255,255,255)".
				 */
			}
		</script>
	</body>
</html>
