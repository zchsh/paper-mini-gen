<!DOCTYPE html>
<html>
	<head>
		<!-- SILHOUETTE - could try to figure out how to include as a module? -->
		<script src="/js-modules/modules/02-silhouette/image.min.js"></script>
		<!-- TRACE - could try to figure out how to include as a module? -->
		<script src="/js-modules/modules/03-trace/imagetracer_v1.2.6.js"></script>
		<!-- TRACE CLEANUP -->
		<script src="/js-modules/modules/03-trace/flatten-svg/path-data-polyfill.js"></script>
		<!-- TODO: the TRACE CLEANUP scripts below this comment could be modules -->
		<script src="/js-modules/modules/03-trace/flatten-svg/svg-to-paths.js"></script>
		<script src="/js-modules/modules/03-trace/render-polygons-as-path-svg.js"></script>
		<!-- OFFSET -->
		<!-- TODO: add scripts -->
		<!-- main module -->
		<script type="module" src="/js-modules/main.js"></script>
		<!-- main execution -->
		<script>
			async function runAll() {
				await silhouetteExecute("raw-image", "processed-image");
				await traceExecute("processed-image", "trace-svg");
			}

			async function resetAndRunAll() {
				silhouetteResetSettings();
				await runAll();
			}
		</script>
	</head>
	<body onload="resetAndRunAll()">
		<!--  -->
		<!--  -->
		<!--  -->
		<h2>UPLOAD</h2>
		<!--  -->
		<!--  -->
		<!--  -->

		<p>
			<input
				type="file"
				id="image-input"
				accept="image/png, image/jpeg"
				onchange="onImageSelection(this, 'raw-image', resetAndRunAll)"
			/>
		</p>

		<!--  -->
		<!--  -->
		<!--  -->
		<h2>SILHOUETTE</h2>
		<!--  -->
		<!--  -->
		<!--  -->

		<div style="display: flex; align-items: center">
			<img id="raw-image" src="/sample-char-art-00.jpeg" />
			<img id="processed-image" />
		</div>

		<h3>Silhouette tweaks</h3>
		<p>
			Threshold (100 means auto)
			<input id="threshold" type="number" min="0" max="100" value="100" />
		</p>
		<p>
			Radius
			<input id="radius" type="number" min="1" max="100" value="5" />
		</p>
		<p>
			<button onClick="runAll()">Apply silhouette tweaks</button>
		</p>

		<!--  -->
		<!--  -->
		<!--  -->
		<h2>TRACE</h2>
		<!--  -->
		<!--  -->
		<!--  -->

		<div id="trace-svg"></div>
		<h3>Trace tweaks</h3>
		<p>Path omit: <input id="pathomit" type="number" min="0" value="30" /></p>
		<p>
			<button onClick="runAll()">Apply trace tweaks</button>
		</p>

		<!--  -->
		<!--  -->
		<!--  -->
		<h2 style="color: magenta">OFFSET</h2>
		<!--  -->
		<!--  -->
		<!--  -->

		<p>
			TODO: add offset, based on
			<a href="/toy-offset-and-addition">/toy-offset-and-addition</a>
		</p>
	</body>
</html>
